---
import '../styles/global.css';

// src/pages/404.astro
import SearchHeader from '../components/SearchHeader.astro';
import Footer from '../components/Footer.astro';
import GA from '../components/GoogleAnalytics.astro';
import { getCollection } from 'astro:content';

// 1. Fetch data to generate the "Helpful Links" section
const allFoods = await getCollection('foods');
const categories = [...new Set(allFoods.flatMap((item) => item.data.category))].sort();
---

<html lang="en">
  <head>
    <GA id="G-EYN5ZFZK56" />
    
    <title>Page Not Found | Is It Safe For My Dog?</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    
    <!-- NoIndex prevents Google from indexing your error page -->
    <meta name="robots" content="noindex" />
  </head>
  <body class="bg-gray-50 min-h-screen font-sans flex flex-col">
    
    <SearchHeader />

    <main class="flex-grow flex flex-col items-center justify-center px-6 py-20 text-center">
      
      <!-- 1. The Visual / Pun -->
      <div class="mb-6 relative">
        <span class="text-9xl">üê∂</span>
        <div class="absolute -bottom-2 -right-2 text-6xl rotate-12">
            ‚ùì
        </div>
      </div>

      <h1 class="text-5xl font-extrabold text-blue-900 mb-4">Ruh-roh!</h1>
      <p class="text-xl text-gray-600 max-w-md mx-auto mb-8">
        We sniffed everywhere, but we couldn't find the page you were looking for. It might have been buried in the backyard.
      </p>

      <!-- 2. Primary Action: Go Home -->
      <a 
        href="/" 
        class="inline-block bg-blue-600 text-white font-bold text-lg px-8 py-3 rounded-full shadow-lg hover:bg-blue-700 hover:shadow-xl transition-all transform hover:-translate-y-1"
      >
        Go Back Home
      </a>

      <!-- 3. Secondary Action: Browse Categories -->
      <div class="mt-16 w-full max-w-4xl border-t border-gray-200 pt-12">
        <h2 class="text-gray-400 text-sm font-bold uppercase tracking-widest mb-6">
          Or Browse by Category
        </h2>
        
        <div class="flex flex-wrap justify-center gap-3">
          {categories.map(cat => (
              <a 
                href={`/category/${cat.toLowerCase().replace(/\s+/g, '-')}`} 
                class="bg-white px-4 py-2 rounded-full text-blue-900 font-medium shadow-sm border border-blue-100 hover:bg-blue-600 hover:text-white hover:border-blue-600 transition"
              >
                  {cat}
              </a>
          ))}
        </div>
      </div>

    </main>

    <Footer />
  </body>
</html>